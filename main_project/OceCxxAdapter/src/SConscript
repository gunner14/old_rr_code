Import('env')
Import('ice_libs')
Import('boost_libs')
Import('db_libs')
Import('cpp_')


env.PrependUnique(CPPPATH=env['SLICECSLICEPATH'])

xceadapter = env.StaticLibrary('xceadapter', 
  source = [
            env.Protoc('#/OceProto/proto/DistributedCacheSchema.proto'),
            env.Protoc('#/OceProto/proto/UserCache.proto'),
            env.Slicec('#/UtilSlice/slice/Util.ice'),
            env.Slicec('#/UtilSlice/slice/XceAlert.ice'),
            env.Slicec('#/UtilSlice/slice/DataWrapper.ice'),
            env.Slicec('#/UtilSlice/slice/DbDescriptor.ice'),
            env.Slicec('#/UtilSlice/slice/MasterSlaveServer.ice'),
            env.Slicec('#/UtilSlice/slice/ObjectCache.ice'),
            env.Slicec('#/UtilSlice/slice/Proxy.ice'),
            env.Slicec('#/UtilSlice/slice/SubjectObserver.ice'),
            env.Slicec('#/UtilSlice/slice/ReplicaCluster.ice'),
            env.Slicec('#/UtilSlice/slice/SvcDescriptor.ice'),
            env.Slicec('#/UtilSlice/slice/TaskManagerAPI.ice'),
            env.Slicec('#/UtilSlice/slice/XceLogger.ice'),
            env.Slicec('#/UtilSlice/slice/XceMonitor.ice'),
						env.Slicec('#/OceSlice/slice/XceStorm.ice'), 
						env.Slicec('#/OceSlice/slice/UserCache.ice'), 
						env.Slicec('#/OceSlice/slice/UserBase.ice'), 
						env.Slicec('#/OceSlice/slice/Ticket.ice'), 
            env.Slicec('#/OceSlice/slice/SocialGraphMessage.ice'), 
            env.Slicec('#/OceSlice/slice/SocialGraphLogic.ice'), 
            env.Slicec('#/OceSlice/slice/BuddyByIdCache.ice'),
            '#/XceAlert/src/XceAlertI.cpp', 
            '#/UtilCxx/src/Singleton.h',
            '#/UtilCxx/src/LogWrapper.h',
            '#/UtilCxx/src/TaskManager.cpp',
            '#/UtilCxx/src/Allocator.cpp',
            '#/UtilCxx/src/CharsetCnvtr.cpp',
            '#/UtilCxx/src/Date.cpp',
            '#/UtilCxx/src/Parser.cpp',
            '#/UtilCxx/src/Pipe.cpp',
            '#/UtilCxx/src/quicklz.cpp',
            '#/UtilCxx/src/ThreadPoolExecutor.cpp',
            '#/UtilCxx/src/ThreadPoolScheduler.cpp',
						'#/util/cpp/TimeCost.h',
            '#/util/cpp/IpAddr.hpp',
            '#/IceExt/src/AdapterI.cpp',
            '#/IceExt/src/Channel.cpp',
            '#/IceExt/src/DataSet.h',
            '#/IceExt/src/DataWrapperI.cpp',
            '#/IceExt/src/IceAmdTask.h',
            '#/IceExt/src/IceLogger.h',
            '#/IceExt/src/ObjectCacheI.cpp',
            '#/IceExt/src/ServiceI.cpp',
            '#/IceExt/src/TopicI.cpp',
            '#/IceExt/src/TopicManagerI.cpp',
            '#/IceExt/src/XceStormAdapter.cpp',
            '#/DbCxxPool/src/ConnectionHolder.cpp',
            '#/DbCxxPool/src/ConnectionPool.cpp',
            '#/DbCxxPool/src/ConnectionPoolManager.cpp',
            '#/DbCxxPool/src/ConnectionQuery.cpp',
            '#/DbCxxPool/src/QueryRunner.cpp',
            '#/ReplicaCluster/ClusterState/src/client/cxx/ClusterStateSubscriber.cpp',
            '#/ReplicaCluster/ClusterState/src/server/ClusterStateListener.cpp',
            '#/ReplicaCluster/SubjectObserver/src/client/cxx/SbjTopicI.cpp',
            '#/ReplicaCluster/SubjectObserver/src/server/SubjectObserverI.cpp',
            '#/ReplicaCluster/ServerState/src/client/cxx/ServerStateSubscriber.cpp',
            '#/ReplicaCluster/ServerState/src/server/ServerStateListener.cpp',
#           env.Slicec('#/DistCache/distributedcache/slice/DistributedCache.ice'),
#           '#/DistCache/distributedcache/src/main/cpp/ClusterManager.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/ClusterManagerFactory.h',
#           '#/DistCache/distributedcache/src/main/cpp/DistCacheAdapter.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/Distribution.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/MemcachedClientPool.h',
#           '#/DistCache/distributedcache/src/main/cpp/Node.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/PreferManager.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/ZkManager.cpp',
#           '#/DistCache/distributedcache/src/main/cpp/ZkManagerFactory.h',
            'SocialGraphLogicAdapter.cpp',
						'BuddyByIdReplicaAdapter.cpp',
            'DistUserCacheReloaderAdapter.cpp',
						'UserCacheReloaderAdapter.cpp',
			      'UserCacheAdapter.cpp'
           ],
		  LIBS = [
               ice_libs, 
               db_libs, 
               boost_libs, 
               'protobuf',
               'log4cplus'
  ])

to_export = {'xceadapter' : xceadapter}
Return('to_export') 
